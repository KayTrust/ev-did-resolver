jasmine.DEFAULT_TIMEOUT_INTERVAL = 2000000000;
const DIDResolver = require('did-resolver').Resolver;
const EvResolver = require('../lib/index');
const host = 'https://api-gateway-dev.demo.kaytrust.id/backend/ms-besu-service';
const abi = [{'inputs':[],'payable':false,'stateMutability':'nonpayable','type':'constructor'},{'anonymous':false,'inputs':[{'indexed':false,'internalType':'address','name':'proxy','type':'address'},{'indexed':false,'internalType':'address','name':'newUser','type':'address'}],'name':'AccountRecovered','type':'event'},{'anonymous':false,'inputs':[{'indexed':false,'internalType':'address','name':'identity','type':'address'},{'indexed':false,'internalType':'address','name':'device','type':'address'},{'indexed':false,'internalType':'string','name':'cap','type':'string'},{'indexed':false,'internalType':'uint256','name':'start_date','type':'uint256'},{'indexed':false,'internalType':'uint256','name':'end_date','type':'uint256'}],'name':'CapSet','type':'event'},{'anonymous':false,'inputs':[{'indexed':false,'internalType':'address','name':'proxy','type':'address'}],'name':'IdentityCreated','type':'event'},{'anonymous':false,'inputs':[{'indexed':false,'internalType':'address','name':'proxy','type':'address'}],'name':'IdentityRegistered','type':'event'},{'anonymous':false,'inputs':[{'indexed':false,'internalType':'address','name':'proxy','type':'address'}],'name':'IdentityUnregistered','type':'event'},{'anonymous':false,'inputs':[{'indexed':true,'internalType':'string','name':'username','type':'string'},{'indexed':false,'internalType':'address','name':'from','type':'address'}],'name':'MnemonicSet','type':'event'},{'anonymous':false,'inputs':[{'indexed':false,'internalType':'address','name':'oldIdentityManager','type':'address'},{'indexed':false,'internalType':'address','name':'newIdentityManager','type':'address'}],'name':'Upgraded','type':'event'},{'constant':false,'inputs':[{'internalType':'bytes16','name':'keyMnemonic','type':'bytes16'},{'internalType':'bytes16','name':'keyProfile','type':'bytes16'},{'internalType':'string','name':'urlProfile','type':'string'},{'internalType':'string','name':'username','type':'string'},{'internalType':'string','name':'salt','type':'string'}],'name':'createIdentity','outputs':[{'internalType':'address','name':'','type':'address'}],'payable':false,'stateMutability':'nonpayable','type':'function'},{'constant':false,'inputs':[{'internalType':'contract Proxy','name':'identity','type':'address'},{'internalType':'address','name':'destination','type':'address'},{'internalType':'uint256','name':'value','type':'uint256'},{'internalType':'bytes','name':'data','type':'bytes'}],'name':'forwardTo','outputs':[],'payable':false,'stateMutability':'nonpayable','type':'function'},{'constant':true,'inputs':[{'internalType':'contract Proxy','name':'identity','type':'address'},{'internalType':'address','name':'device','type':'address'},{'internalType':'string','name':'cap','type':'string'}],'name':'hasCap','outputs':[{'internalType':'bool','name':'','type':'bool'}],'payable':false,'stateMutability':'view','type':'function'},{'constant':false,'inputs':[{'internalType':'contract Proxy','name':'identity','type':'address'},{'internalType':'address','name':'owner','type':'address'}],'name':'registerIdentity','outputs':[],'payable':false,'stateMutability':'nonpayable','type':'function'},{'constant':true,'inputs':[{'internalType':'address','name':'','type':'address'}],'name':'registered_identities','outputs':[{'internalType':'bool','name':'','type':'bool'}],'payable':false,'stateMutability':'view','type':'function'},{'constant':false,'inputs':[{'internalType':'contract Proxy','name':'identity','type':'address'},{'internalType':'address','name':'device','type':'address'},{'internalType':'string','name':'cap','type':'string'},{'internalType':'uint256','name':'start_date','type':'uint256'},{'internalType':'uint256','name':'end_date','type':'uint256'}],'name':'setCap','outputs':[],'payable':false,'stateMutability':'nonpayable','type':'function'},{'constant':false,'inputs':[{'internalType':'contract Proxy','name':'identity','type':'address'},{'internalType':'address','name':'device','type':'address'},{'internalType':'uint256','name':'start_date','type':'uint256'},{'internalType':'uint256','name':'end_date','type':'uint256'}],'name':'setDevice','outputs':[],'payable':false,'stateMutability':'nonpayable','type':'function'},{'constant':false,'inputs':[{'internalType':'contract Proxy','name':'identity','type':'address'}],'name':'unregisterIdentity','outputs':[],'payable':false,'stateMutability':'nonpayable','type':'function'},{'constant':false,'inputs':[{'internalType':'contract Proxy','name':'identity','type':'address'},{'internalType':'contract IdentityManager','name':'newIdentityManager','type':'address'}],'name':'upgrade','outputs':[],'payable':false,'stateMutability':'nonpayable','type':'function'}];
const address = '0xa6b4540a2bfbe8663caa78027c83d0dcb1b7c837';

describe("EV Resolver", () => {

	let resolver;

	beforeAll(() => {
		const headers = [{ name: 'Authorization', value: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI4OXp2WUZMZkJuREZwc2d2Rk1GQV9iMTc1M2Zma2dZV3hHZFpvajVueUFFIn0.eyJleHAiOjE2NTU2MTk4MDcsImlhdCI6MTY1NTU4MzgwOCwiYXV0aF90aW1lIjoxNjU1NTgzODA3LCJqdGkiOiJlZTI1OGJiOC03MDFjLTQyNDctOWQ1Ni00MThiNWM0Yzc4NDEiLCJpc3MiOiJodHRwczovL2F1dGgtZGV2LmRlbW8ua2F5dHJ1c3QuaWQvYXV0aC9yZWFsbXMvUHJvdmlkZXItVGVzdCIsImF1ZCI6WyJrdFByb3ZpZGVyU2hlbGwiLCJhY2NvdW50Il0sInN1YiI6IjdlNGQyYjQxLThiOTYtNGNhYS1iYWJkLTRjYmVkOTg5ZGYyMiIsInR5cCI6IkJlYXJlciIsImF6cCI6IndhbGxldENsaWVudCIsIm5vbmNlIjoiczhGSmstaEgycmFUd2Ffdm9nWWppZyIsInNlc3Npb25fc3RhdGUiOiI2ZDA4NzUwYy0xOTZhLTRiNzYtYjEyMS04M2U0NDIwYTQ1N2IiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbIioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtcHJvdmlkZXItdGVzdCIsIm9mZmxpbmVfYWNjZXNzIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJrdFByb3ZpZGVyU2hlbGwiOnsicm9sZXMiOlsibW9kdWxlOjppZGVudGl0eSIsIm1vZHVsZTo6cHJlc2VudGF0aW9uIiwibW9kdWxlOjpjcmVkZW50aWFsIl19LCJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCIsInNpZCI6IjZkMDg3NTBjLTE5NmEtNGI3Ni1iMTIxLTgzZTQ0MjBhNDU3YiJ9.PRuzJ31TWKNQx_Pp0Z4w0CKOtcFhwZV55PCui3AhKgwBXcMyxL-FZv7kOoYzEMyFZ4ZN0Qw3TK2poS-b-zYHeUYkbPT44GOxxb9toUmzHOE5LXkEReUH3x1pqmjvdXNFjKC7XVYM2bVmj5GuRK-IMPrjMVaGb9c4asqE2L_d29zRsSV7SdUfpvyvxXdvhd4xvIvPu-cbQ1yNTVqeA8mdDoBZ7GB7ys2WxmOsOT33C07ANJs3JRIMJO9-yUWMMU99r_rUB-SclozxqFwfZqrPuFfgN7Uhj21763nIre35DPTP3liKOhSCLVE1fhALlDlJVD7sbucYcvi88Ay0GPXY4A' }];
		EvResolver.setConfigResolver(host, abi, address, headers);
		const evResolver = EvResolver.getResolver();
		resolver = new DIDResolver(evResolver);
	});

    it('DIDResolver return a document', () => {
		return resolver.resolve('did:ev:2uzPtwJmXbBqMmP9DkR7dE3FcLmgYejdJ42')
		.then(doc => {
			console.log(doc);
			expect(doc).not.toBeNull();
		});
	});
});